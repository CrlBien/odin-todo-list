(()=>{"use strict";var e={56:(e,t,o)=>{e.exports=function(e){var t=o.nc;t&&e.setAttribute("nonce",t)}},72:e=>{var t=[];function o(e){for(var o=-1,n=0;n<t.length;n++)if(t[n].identifier===e){o=n;break}return o}function n(e,n){for(var i={},r=[],s=0;s<e.length;s++){var a=e[s],l=n.base?a[0]+n.base:a[0],c=i[l]||0,m="".concat(l," ").concat(c);i[l]=c+1;var u=o(m),p={css:a[1],media:a[2],sourceMap:a[3],supports:a[4],layer:a[5]};if(-1!==u)t[u].references++,t[u].updater(p);else{var g=d(p,n);n.byIndex=s,t.splice(s,0,{identifier:m,updater:g,references:1})}r.push(m)}return r}function d(e,t){var o=t.domAPI(t);return o.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;o.update(e=t)}else o.remove()}}e.exports=function(e,d){var i=n(e=e||[],d=d||{});return function(e){e=e||[];for(var r=0;r<i.length;r++){var s=o(i[r]);t[s].references--}for(var a=n(e,d),l=0;l<i.length;l++){var c=o(i[l]);0===t[c].references&&(t[c].updater(),t.splice(c,1))}i=a}}},113:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},314:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var o="",n=void 0!==t[5];return t[4]&&(o+="@supports (".concat(t[4],") {")),t[2]&&(o+="@media ".concat(t[2]," {")),n&&(o+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),o+=e(t),n&&(o+="}"),t[2]&&(o+="}"),t[4]&&(o+="}"),o}).join("")},t.i=function(e,o,n,d,i){"string"==typeof e&&(e=[[null,e,void 0]]);var r={};if(n)for(var s=0;s<this.length;s++){var a=this[s][0];null!=a&&(r[a]=!0)}for(var l=0;l<e.length;l++){var c=[].concat(e[l]);n&&r[c[0]]||(void 0!==i&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=i),o&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=o):c[2]=o),d&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=d):c[4]="".concat(d)),t.push(c))}},t}},540:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},601:e=>{e.exports=function(e){return e[1]}},659:e=>{var t={};e.exports=function(e,o){var n=function(e){if(void 0===t[e]){var o=document.querySelector(e);if(window.HTMLIFrameElement&&o instanceof window.HTMLIFrameElement)try{o=o.contentDocument.head}catch(e){o=null}t[e]=o}return t[e]}(e);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(o)}},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(o){!function(e,t,o){var n="";o.supports&&(n+="@supports (".concat(o.supports,") {")),o.media&&(n+="@media ".concat(o.media," {"));var d=void 0!==o.layer;d&&(n+="@layer".concat(o.layer.length>0?" ".concat(o.layer):""," {")),n+=o.css,d&&(n+="}"),o.media&&(n+="}"),o.supports&&(n+="}");var i=o.sourceMap;i&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(n,e,t.options)}(t,e,o)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},984:(e,t,o)=>{o.d(t,{A:()=>s});var n=o(601),d=o.n(n),i=o(314),r=o.n(i)()(d());r.push([e.id,"// extracted by mini-css-extract-plugin\nexport {};",""]);const s=r}},t={};function o(n){var d=t[n];if(void 0!==d)return d.exports;var i=t[n]={id:n,exports:{}};return e[n](i,i.exports,o),i.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.nc=void 0;var n=o(72),d=o.n(n),i=o(825),r=o.n(i),s=o(659),a=o.n(s),l=o(56),c=o.n(l),m=o(540),u=o.n(m),p=o(113),g=o.n(p),v=o(984),f={};f.styleTagTransform=g(),f.setAttributes=c(),f.insert=a().bind(null,"head"),f.domAPI=r(),f.insertStyleElement=u(),d()(v.A,f),v.A&&v.A.locals&&v.A.locals;class h{constructor(e,t="",o="",n="Low"){this.id=`${Date.now()}-${Math.random().toString(36).slice(2,7)}`,this.title=e.slice(0,50),this.description=t.slice(0,500),this.dueDate=o||"",this.priority=n,this.completed=!1,this.expanded=!1}toggleComplete(){this.completed=!this.completed}toggleExpanded(){this.expanded=!this.expanded}update({title:e,description:t,dueDate:o,priority:n}){void 0!==e&&(this.title=String(e).slice(0,50)),void 0!==t&&(this.description=String(t).slice(0,500)),void 0!==o&&(this.dueDate=o),void 0!==n&&(this.priority=n)}serialize(){return{id:this.id,title:this.title,description:this.description,dueDate:this.dueDate,priority:this.priority,completed:this.completed,expanded:this.expanded}}static deserialize(e){const t=new h(e.title||"",e.description||"",e.dueDate||"",e.priority||"Low");return t.id=e.id||t.id,t.completed=!!e.completed,t.expanded=!!e.expanded,t}}class y{constructor(e=""){this.id=`${Date.now()}-${Math.random().toString(36).slice(2,7)}`,this.text=String(e).slice(0,250)}serialize(){return{id:this.id,text:this.text}}static deserialize(e){const t=new y(e.text||"");return t.id=e.id||t.id,t}}class b{constructor(e){this.id=`${Date.now()}-${Math.random().toString(36).slice(2,7)}`,this.name=String(e).slice(0,100),this.todos=[]}addTodo(e){this.todos.push(e)}removeTodoById(e){const t=this.todos.findIndex(t=>t.id===e);t>-1&&this.todos.splice(t,1)}serialize(){return{id:this.id,name:this.name,todos:this.todos.map(e=>e.serialize())}}static deserialize(e){const t=new b(e.name||"Untitled");return t.id=e.id||t.id,Array.isArray(e.todos)&&(t.todos=e.todos.map(e=>h.deserialize(e))),t}}const x={saveTodos(e){localStorage.setItem("todos",JSON.stringify(e))},saveNotes(e){localStorage.setItem("notes",JSON.stringify(e))},saveProjects(e){localStorage.setItem("projects",JSON.stringify(e))},loadTodos(){const e=localStorage.getItem("todos");if(e)return JSON.parse(e).map(e=>new h(e.title,e.description,e.dueDate,e.priority,e.completed,e.id));const t=new Date,o=e=>e.toISOString().slice(0,10),n=o(t),d=o(new Date(t.getTime()+5184e5)),i=[new h("Buy groceries","Milk, eggs, and bread",n,"High"),new h("Study JavaScript","Review ES6 and DOM manipulation",n,"Medium"),new h("Workout","Do 30 minutes of cardio",n,"Low"),new h("Plan weekend trip","Choose location and book tickets",d,"Medium"),new h("Pay bills","Electricity and internet due soon",d,"High")];return this.saveTodos(i),i},loadNotes(){const e=localStorage.getItem("notes");if(e)return JSON.parse(e).map(e=>new y(e.text,e.id));const t=[new y("Meeting notes: Discussed new project ideas."),new y("Remember to call mom this weekend."),new y("Book to read: 'Clean Code' by Robert C. Martin."),new y("Ideas: build a habit tracker web app."),new y("Quote: 'Simplicity is the soul of efficiency.'"),new y("Recipe: Pasta with garlic, olive oil, and chili flakes.")];return this.saveNotes(t),t},loadProjects(){const e=localStorage.getItem("projects");if(e)return JSON.parse(e).map(e=>{const t=new b(e.name,e.id);return Array.isArray(e.todos)&&e.todos.forEach(e=>{const o=new h(e.title,e.description,e.dueDate,e.priority,e.completed,e.id);t.addTodo(o)}),t})}},E=(()=>{let e=x.loadTodos();return{add:(t,o,n,d)=>{const i=new h(t,o,n,d);return e.push(i),x.saveTodos(e),i},removeById:t=>{e=e.filter(e=>e.id!==t),x.saveTodos(e)},toggleComplete:t=>{const o=e.find(e=>e.id===t);o&&(o.toggleComplete(),x.saveTodos(e))},edit:(t,o)=>{const n=e.find(e=>e.id===t);n&&(n.update(o),x.saveTodos(e))},getAll:()=>e,_raw:()=>e}})(),w=(()=>{let e=x.loadNotes();return{add:t=>{const o=new y(t);return e.push(o),x.saveNotes(e),o},removeById:t=>{e=e.filter(e=>e.id!==t),x.saveNotes(e)},getAll:()=>e}})(),j=(()=>{let e=x.loadProjects();return{addProject:t=>{const o=new b(t);return e.push(o),x.saveProjects(e),o},removeProjectById:t=>{e=e.filter(e=>e.id!==t),x.saveProjects(e)},addTodoToProject:(t,o)=>{const n=e.find(e=>e.id===t);n&&(n.addTodo(o),x.saveProjects(e))},removeTodoFromProject:(t,o)=>{const n=e.find(e=>e.id===t);n&&(n.removeTodoById(o),x.saveProjects(e))},editTodoInProject:(t,o,n)=>{const d=e.find(e=>e.id===t);if(!d)return;const i=d.todos.find(e=>e.id===o);i&&(i.update(n),x.saveProjects(e))},toggleCompleteInProject:(t,o)=>{const n=e.find(e=>e.id===t);if(!n)return;const d=n.todos.find(e=>e.id===o);d&&(d.toggleComplete(),x.saveProjects(e))},getAll:()=>e}})();function I(){return[...E.getAll(),...j.getAll().flatMap(e=>e.todos)]}const L=document.getElementById("tab-title"),C={todo:document.getElementById("todo-section"),today:document.getElementById("today-section"),notes:document.getElementById("notes-section"),projects:document.getElementById("projects-section")},T={todo:document.getElementById("todo-list"),today:document.getElementById("today-list"),notes:document.getElementById("notes-list"),projects:document.getElementById("projects-list")},N={todoForm:document.getElementById("todo-form"),notesForm:document.getElementById("notes-form"),projectForm:document.getElementById("project-form")},B=document.querySelectorAll(".nav-link"),k=document.createElement("button");k.id="fab",k.className="fixed right-8 bottom-8 w-14 h-14 rounded-full bg-blue-600 text-white flex items-center justify-center text-2xl shadow-lg z-40 cursor-pointer",k.textContent="+",document.body.appendChild(k);const S=document.createElement("div");S.id="overlay",S.className="fixed inset-0 hidden z-50 flex items-center justify-center",S.innerHTML='\n  <div class="absolute inset-0 bg-black/40 backdrop-blur-sm"></div>\n  <div class="relative z-10 w-[92%] max-w-3xl flex justify-center">\n    <div id="modal-content" class="bg-white rounded-lg shadow-lg p-6 max-h-[90vh] overflow-y-auto"></div>\n  </div>\n',document.body.appendChild(S);let M="todo",D=null;function A(e){M=e,B.forEach(t=>{t.classList.remove("bg-gray-100","font-semibold"),t.dataset&&t.dataset.tab===e&&t.classList.add("bg-gray-100","font-semibold")})}function P(e){const t=S.querySelector("#modal-content");t&&(t.innerHTML=e,S.classList.remove("hidden"),S.addEventListener("click",e=>{e.target===S&&H()},{once:!0}))}function H(){S.classList.add("hidden");const e=S.querySelector("#modal-content");e&&(e.innerHTML="")}function $(e,t=[]){if(e){if(e.innerHTML="",!t||0===t.length){const t=document.createElement("div");return t.className="text-gray-500",t.textContent="No todos found.",void e.appendChild(t)}t.forEach(t=>{const o=document.createElement("li");o.className="p-3 rounded-lg border flex justify-between gap-4 "+(t.completed?"bg-green-50":"bg-white");const n=document.createElement("div");n.className="flex items-start gap-3 flex-1 min-w-0";const d=document.createElement("button");d.className="w-5 h-5 rounded-sm border shrink-0 cursor-pointer "+(t.completed?"bg-green-400":"bg-white"),d.setAttribute("aria-label","toggle-complete"),d.addEventListener("click",()=>{E.getAll().find(e=>e.id===t.id)?E.toggleComplete(t.id):j.getAll().forEach(e=>{e.todos.find(e=>e.id===t.id)&&j.toggleCompleteInProject(e.id,t.id)}),O()});const i=document.createElement("div");i.className="flex-1 overflow-hidden";const r=document.createElement("div");r.className="flex items-center gap-2";const s=document.createElement("div");s.className="w-3 h-3 rounded-full shrink-0 "+("High"===t.priority?"bg-red-500":"Medium"===t.priority?"bg-yellow-400":"Low"===t.priority?"bg-green-500":"bg-gray-300");const a=document.createElement("div");a.className="font-semibold text-gray-900 truncate",a.textContent=t.title,r.appendChild(s),r.appendChild(a);const l=document.createElement("div");l.className="text-sm text-gray-700 mt-2 overflow-hidden text-ellipsis break-words",l.style.maxHeight=t.expanded?"none":"6rem",l.textContent=t.description||"";const c=document.createElement("div");c.className="text-xs text-gray-500 mt-2 flex items-center gap-2";const m=document.createElement("span");m.textContent=t.dueDate||"No date";const u=document.createElement("span");u.textContent=t.priority,u.className="text-white px-2 py-0.5 rounded text-[10px] font-medium "+("High"===t.priority?"bg-red-500":"Medium"===t.priority?"bg-yellow-400 text-black":"Low"===t.priority?"bg-green-500":"bg-gray-400"),c.appendChild(m),c.appendChild(u),i.appendChild(r),i.appendChild(l),i.appendChild(c),n.appendChild(d),n.appendChild(i);const p=document.createElement("div");p.className="flex flex-col justify-start items-end gap-2 shrink-0";const g=document.createElement("button");g.className="text-blue-600 px-2 cursor-pointer",g.title="Edit",g.innerHTML='<i class="fa-solid fa-pen-to-square"></i>',g.addEventListener("click",()=>z({editTodo:t}));const v=document.createElement("button");v.className="text-red-600 px-2 cursor-pointer",v.title="Delete",v.innerHTML='<i class="fa-solid fa-trash"></i>',v.addEventListener("click",()=>{confirm("Delete this todo?")&&(E.getAll().find(e=>e.id===t.id)?E.removeById(t.id):j.getAll().forEach(e=>{e.todos.find(e=>e.id===t.id)&&j.removeTodoFromProject(e.id,t.id)}),O())}),p.appendChild(g),p.appendChild(v),o.appendChild(n),o.appendChild(p),e.appendChild(o)})}}function O(){if(L)if(C.todo&&C.notes&&C.projects&&C.today)if(T.todo&&T.today&&T.notes&&T.projects)if(Object.values(C).forEach(e=>e.classList.add("hidden")),"todo"===M)L.textContent="Todo",C.todo.classList.remove("hidden"),$(T.todo,E.getAll()),k.style.display="block";else if("today"===M){L.textContent="Today",C.today.classList.remove("hidden");const e=I(),t=(new Date).toISOString().slice(0,10),o=e.filter(e=>e.dueDate===t);$(T.today,o),k.style.display="none"}else if("today"===M){L.textContent="Today",C.today.classList.remove("hidden");const e=I(),t=(new Date).toISOString().slice(0,10),o=e.filter(e=>e.dueDate&&e.dueDate===t);$(T.today,o),k.style.display="none"}else"notes"===M?(L.textContent="Notes",C.notes.classList.remove("hidden"),q(),k.style.display="block"):"projects"===M&&(L.textContent="Projects",C.projects.classList.remove("hidden"),D?(function(e){if(!T.projects)return;const t=j.getAll().find(t=>t.id===e);if(!t)return D=null,F();T.projects.innerHTML="";const o=document.createElement("div");o.className="flex items-center justify-between mb-3",o.innerHTML=`<div><div class="font-bold text-lg">${t.name}</div><div class="text-sm text-gray-500">${t.todos.length} todos</div></div>\n    <div class="flex items-center gap-2">\n      <button id="back-to-projects" class="text-gray-600"><i class="fa-solid fa-arrow-left"></i></button>\n    </div>`,T.projects.appendChild(o);const n=document.getElementById("back-to-projects");n&&n.addEventListener("click",()=>{D=null,O()});const d=document.getElementById("del-project");d&&d.addEventListener("click",()=>{confirm("Delete project and its todos?")&&(j.removeProjectById(t.id),D=null,O())});const i=document.createElement("div");if(i.className="flex flex-col gap-3",t.todos&&0!==t.todos.length)$(i,t.todos);else{const e=document.createElement("div");e.className="text-gray-500",e.textContent="No todos yet. Click + to add to this project.",i.appendChild(e)}T.projects.appendChild(i)}(D),k.style.display="block"):(F(),k.style.display="none"));else console.warn("One or more list containers missing",T);else console.warn("One or more section elements missing",C);else console.warn("tabTitle element missing")}function q(){if(!T.notes)return;T.notes.innerHTML="";const e=w.getAll();if(!e||0===e.length)return void(T.notes.innerHTML='<div class="text-gray-500">No notes yet.</div>');const t=document.createElement("div");t.className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",e.forEach(e=>{const o=document.createElement("div");o.className="bg-yellow-50 p-4 rounded shadow min-h-[200px] relative",o.innerHTML=`<div class="text-xs text-gray-500 mb-2">Note</div>\n      <div class="whitespace-pre-wrap">${e.text}</div>\n      <button class="absolute top-2 right-2 text-red-500 cursor-pointer" title="Delete note"><i class="fa-solid fa-trash"></i></button>`,o.querySelector("button").addEventListener("click",()=>{confirm("Delete note?")&&(w.removeById(e.id),q())}),t.appendChild(o)}),T.notes.appendChild(t)}function F(){if(!T.projects)return;T.projects.innerHTML="";const e=j.getAll();e&&0!==e.length||(T.projects.innerHTML='<div class="text-gray-500">No projects yet.</div>'),e.forEach(e=>{const t=document.createElement("div");t.className="mb-3 bg-white p-3 rounded shadow cursor-pointer hover:bg-gray-50 transition",t.addEventListener("click",()=>{D=e.id,A("projects"),O()});const o=document.createElement("div");o.className="flex items-center justify-between";const n=document.createElement("div");n.className="flex items-center gap-3",n.innerHTML=`<div class="font-semibold">${e.name}</div>`;const d=document.createElement("div");d.className="flex items-center gap-2";const i=document.createElement("button");i.className="text-red-600 cursor-pointer hover:text-red-700 transition",i.title="Delete project",i.innerHTML='<i class="fa-solid fa-trash"></i>',i.addEventListener("click",t=>{t.stopPropagation(),confirm("Delete project and all its todos?")&&(j.removeProjectById(e.id),O())}),d.appendChild(i),o.appendChild(n),o.appendChild(d),t.appendChild(o);const r=document.createElement("div");r.className="mt-2",e.todos.slice(0,2).forEach(e=>{const t=document.createElement("div");t.className="bg-white p-2 rounded border mt-1 text-sm",t.innerHTML=`<div class="font-medium">${e.title}</div>\n        <div class="text-xs text-gray-500">${e.dueDate||""} • ${e.priority}</div>`,r.appendChild(t)}),r.children.length&&t.appendChild(r),T.projects.appendChild(t)});const t=document.createElement("div");t.className="mt-4 ml-6",t.innerHTML='<button id="add-project-toggle" class="text-blue-600 cursor-pointer hover:underline">+ Add Project</button>',T.projects.appendChild(t);const o=document.getElementById("add-project-toggle");o&&o.addEventListener("click",()=>{const e=document.createElement("div");e.className="mt-4 ml-6 bg-white p-4 rounded shadow flex flex-col gap-3 w-full max-w-md",e.innerHTML='\n        <input id="new-project-name" class="border p-2 rounded w-full" placeholder="Project name..." />\n        <div class="flex justify-end gap-3">\n          <button id="cancel-project" class="px-3 py-1 rounded border border-gray-300 hover:bg-gray-100">Cancel</button>\n          <button id="create-project" class="px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white rounded">Create</button>\n        </div>\n      ',T.projects.replaceChild(e,t);const o=e.querySelector("#create-project"),n=e.querySelector("#cancel-project"),d=e.querySelector("#new-project-name");o.addEventListener("click",()=>{const e=d.value.trim();e&&(j.addProject(e),D=null,O())}),n.addEventListener("click",()=>{O()})})}function z({folderProjectId:e=null,editTodo:t=null}={}){const o=t?t.title:"",n=t?t.description:"",d=t?t.dueDate:"",i=t?t.priority:"Low";P(`\n    <div class="flex gap-6">\n      <div class="flex-1">\n        <div class="font-bold mb-2">${t?"Edit Todo":"Add Todo"}</div>\n        <input id="m-title" maxlength="50" placeholder="Title" value="${J(o)}" class="w-full border p-2 rounded mb-3" />\n        <textarea id="m-desc" maxlength="500" placeholder="Description" class="w-full border p-2 rounded h-40">${J(n)}</textarea>\n      </div>\n      <div class="w-56 pl-4 border-l">\n        <div class="font-semibold mb-2">Priority</div>\n        <div class="flex flex-col gap-2">\n          <button id="prio-low" class="py-2 rounded ${"Low"===i?"bg-green-100":""}">Low</button>\n          <button id="prio-med" class="py-2 rounded ${"Medium"===i?"bg-yellow-100":""}">Medium</button>\n          <button id="prio-high" class="py-2 rounded ${"High"===i?"bg-red-100":""}">High</button>\n        </div>\n        <div class="mt-4">\n          <div class="font-semibold mb-2">Due Date</div>\n          <input id="m-date" type="date" value="${d}" class="w-full border p-2 rounded" />\n        </div>\n      </div>\n    </div>\n    <div class="flex justify-end gap-3 mt-4">\n      <button id="modal-cancel" class="px-3 py-1">Cancel</button>\n      <button id="modal-save" class="px-4 py-2 bg-blue-600 text-white rounded">${t?"Save":"Add"}</button>\n    </div>\n  `);let r=i;function s(){const e=document.getElementById("prio-low"),t=document.getElementById("prio-med"),o=document.getElementById("prio-high");e&&t&&o&&(e.classList.toggle("bg-green-100","Low"===r),t.classList.toggle("bg-yellow-100","Medium"===r),o.classList.toggle("bg-red-100","High"===r))}s();const a=document.getElementById("prio-low"),l=document.getElementById("prio-med"),c=document.getElementById("prio-high");a&&a.addEventListener("click",()=>{r="Low",s()}),l&&l.addEventListener("click",()=>{r="Medium",s()}),c&&c.addEventListener("click",()=>{r="High",s()});const m=document.getElementById("modal-cancel");m&&m.addEventListener("click",H);const u=document.getElementById("modal-save");u&&u.addEventListener("click",()=>{const o=document.getElementById("m-title").value.trim().slice(0,50),n=document.getElementById("m-desc").value.trim().slice(0,500),d=document.getElementById("m-date").value;if(!o)return alert("Title required (max 50 chars)");if(t)E.getAll().find(e=>e.id===t.id)?E.edit(t.id,{title:o,description:n,dueDate:d,priority:r}):j.getAll().forEach(e=>{e.todos.find(e=>e.id===t.id)&&j.editTodoInProject(e.id,t.id,{title:o,description:n,dueDate:d,priority:r})});else if((i=e)&&j.getAll().find(e=>e.id===i)){const t=E.add(o,n,d,r);E.removeById(t.id),j.addTodoToProject(e,t)}else E.add(o,n,d,r);var i;H(),O()})}function J(e){return String(e||"").replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;")}B.forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.tab;t&&(D=null,A(t),O())})}),N.todoForm&&N.todoForm.addEventListener("submit",e=>{e.preventDefault();const t=document.getElementById("todo-title"),o=document.getElementById("todo-description"),n=document.getElementById("todo-date"),d=document.getElementById("todo-priority"),i=t?t.value.trim().slice(0,50):"",r=o?o.value.trim().slice(0,500):"",s=n?n.value:"",a=d?d.value:"Low";if(!i)return alert("Title required");E.add(i,r,s,a),e.target.reset(),O()}),N.notesForm&&N.notesForm.addEventListener("submit",e=>{e.preventDefault();const t=document.getElementById("note-text"),o=t?t.value.trim().slice(0,250):"";if(!o)return alert("Note required");w.add(o),e.target.reset(),O()}),N.projectForm&&N.projectForm.addEventListener("submit",e=>{e.preventDefault();const t=document.getElementById("project-name"),o=t?t.value.trim():"";if(!o)return alert("Project name required");j.addProject(o),e.target.reset(),O()}),k.addEventListener("click",()=>{"todo"===M?z({folderProjectId:null}):"notes"===M?function(e=null){const t=e?e.text:"";P(`\n    \x3c!-- Modal Overlay --\x3e <div class="fixed inset-0 flex items-center justify-center backdrop-blur-sm bg-white/30 z-50"> \x3c!-- Modal Box --\x3e <div class="bg-white rounded-lg shadow-lg p-6 w-96 max-w-full"> <div class="font-bold mb-2">${e?"Edit Note":"Add Note"}</div> <textarea id="m-note" maxlength="250" class="w-full border p-2 rounded h-44" >${J(t)}</textarea> <div class="flex justify-end gap-2 mt-3"> <button id="note-cancel" class="px-3 py-1 rounded border border-gray-300 hover:bg-gray-100">Cancel</button> <button id="note-save" class="bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded" > Save </button> </div> </div> </div>\n  `);const o=document.getElementById("note-cancel"),n=document.getElementById("note-save");o&&o.addEventListener("click",H),n&&n.addEventListener("click",()=>{const t=document.getElementById("m-note").value.trim().slice(0,250);if(!t)return alert("Note cannot be empty");e||w.add(t),H(),O()})}():"projects"===M&&D&&z({folderProjectId:D})}),A("todo"),O()})();